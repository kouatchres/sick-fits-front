{"version":3,"file":"static/webpack/static\\development\\pages\\items.js.c8e48cc405a6986304f9.hot-update.js","sources":["webpack:///./components/DeleteItem.js"],"sourcesContent":["import React, {Component} from 'react'\r\nimport { Mutation } from 'react-apollo';\r\nimport gql from 'graphql-tag';\r\nimport { ALL_ITEMS_QUERY } from './Items';\r\nimport { PAGINATION_QUERY } from './Pagination';\r\n\r\n\r\nconst DELETE_ITEM_MUTATION = gql`\r\nmutation DELETE_ITEM_MUTATION($id: ID!){\r\n    deleteItem(id: $id){\r\n        id\r\n}}\r\n`;\r\n\r\n\r\nclass DeleteItem extends Component {\r\n  \r\n  update =(cache, payload)=>{\r\n// 1. reach cache for all the items present\r\nconst data = cache.readQuery({query:ALL_ITEMS_QUERY});\r\nconsole.log(data, payload);\r\n\r\n// 2. filter the deleted item out of the page\r\ndata.items= data.items.filter(item=> (\r\n    item.id !== payload.data.deleteItem.id \r\n));\r\n//3. put back the remaining items not deleted\r\n cache.writeQuery({ query: ALL_ITEMS_QUERY , data });\r\n console.log(data, payload);\r\n\r\n  };\r\n    render() {\r\n        return (\r\n        <Mutation \r\n        mutation={DELETE_ITEM_MUTATION}\r\n         variables={{id: this.props.id}}\r\n         update={this.update}\r\n         refetchQueries={[{ query: ALL_ITEMS_QUERY },{ query: PAGINATION_QUERY }]}\r\n\r\n         >\r\n                {(deleteItem, {error}) => (\r\n                    <button\r\n                        onClick={() => {\r\n                        if (confirm('Are you sure you want to delete this Item?')) {\r\n                            deleteItem().catch(error=>{\r\n\r\n                                alert.error.ALL_ITEMS_QUERY\r\n                            });\r\n                            {/* catch(err=> {alert(err.message);}) */}\r\n                        }\r\n                    }}>{this.props.children}</button>\r\n                )}\r\n            </Mutation>\r\n        );\r\n    }\r\n}\r\nexport default DeleteItem;\r\n\r\n\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAGA;AACA;AAOA;;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AAGA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;;;;;;AAAA;AAAA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAcA;;;;AAvCA;AACA;AAwCA;;;;A","sourceRoot":""}